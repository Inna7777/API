<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- Подключаем Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <style>
      .title {
        text-align: center;
        color: rgb(125, 168, 89);
      }
    </style>
  </head>
  <body>
    <!-- Вы разрабатываете веб-страницу для отображения расписания занятий в спортивном клубе. Каждое занятие имеет название, время проведения, максимальное количество участников и текущее количество записанных участников.

1. Создайте веб-страницу с заголовком "Расписание занятий" и областью для отображения занятий.

2. Загрузите информацию о занятиях из предоставленных JSON-данных. Каждое занятие должно отображаться на странице с указанием его названия, времени проведения, максимального количества участников и текущего количества записанных участников.

3. Пользователь может нажать на кнопку "Записаться" для записи на занятие. Если максимальное количество участников уже достигнуто, кнопка "Записаться" становится неактивной.

4. После успешной записи пользователя на занятие, обновите количество записанных участников и состояние кнопки "Записаться".

5. Запись пользователя на занятие можно отменить путем нажатия на кнопку "Отменить запись". После отмены записи, обновите количество записанных участников и состояние кнопки.

6. Все изменения (запись, отмена записи) должны сохраняться и отображаться в реальном времени на странице.

7. При разработке используйте Bootstrap для стилизации элементов. -->
    <div class="content">
      <h1 class="title">Расписание занятий</h1>
      <table class="table table-hover table-bordered">
        <thead class="table-secondary table-title">
          <tr>
            <th scope="col">Название занятия</th>
            <th scope="col">Время проведения</th>
            <th scope="col">Наполняемость групп</th>
            <th scope="col">Количество участников</th>
            <th scope="col">Записаться/Отменить запись</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <script>
      const scheduleInfo = [
        {
          name: "Йога",
          time: "10:00 - 11:00",
          maxStudents: 20,
          currentStudents: 15,
        },
        {
          name: "Фитнес",
          time: "12:00 - 13:00",
          maxStudents: 15,
          currentStudents: 10,
        },
      ];

      //Cоздаем расписание

      const scheduleTable = document.getElementsByTagName("tbody")[0]; // Указываем индекс 0, чтобы получить первый tbody;

      scheduleInfo.forEach((item) => {
        const row = document.createElement("tr");
        row.classList.add("row_info");
        row.innerHTML = `<th >${item.name}</th>
                <td>${item.time}</td>
                <td class ='maxnumber'>${item.maxStudents}</td>
                <td class= 'currentnumber'>${item.currentStudents}</td>
                <td><button class="btn_recording">Записаться</button>
                <button class="btn_canselRecording"  style="display: none" >Отменить запись</button></td>`;
        scheduleTable.append(row);

        if (localStorage.getItem(`${item.name}`)) {
          row.innerHTML = localStorage.getItem(`${item.name}`);
        }
      });

      // Находим все кнопки записаться
      const recordingBtns = document.querySelectorAll(".btn_recording");

      recordingBtns.forEach((recordingBtn) => {
        recordingBtn.addEventListener("click", () => {
          const row = recordingBtn.closest(".row_info"); //поиск родительского элемента с классом row_info"
          if (!row) {
            return;
          }
          const currentStudents = row.querySelector(".currentnumber");
          const maxStudents = row.querySelector(".maxnumber");
          const canselRecordingBtn = row.querySelector(".btn_canselRecording");

          if (
            parseInt(currentStudents.textContent) >=
            parseInt(maxStudents.textContent)
          ) {
            recordingBtn.disabled = true;
            return alert(`Группа набрана. Запись не возможна`);
          }

          currentStudents.textContent =
            parseInt(currentStudents.textContent) + 1;
          //
          recordingBtn.style.display = "none";
          alert("Поздравляем вы успешно записались");

          canselRecordingBtn.style.display = "block";

          // Обновляем значение в LocalStorage
          const itemName = row.querySelector("th").textContent;

          // Сохраняем данные в LocalStorage
          localStorage.setItem(itemName, row.innerHTML);
        });
      });
      // Находим все кнопки записаться
      const canselRecordingBtns = document.querySelectorAll(
        ".btn_canselRecording"
      );

      canselRecordingBtns.forEach((canselRecordingBtn) => {
        canselRecordingBtn.addEventListener("click", () => {
          const row = canselRecordingBtn.closest(".row_info"); //поиск родительского элемента с классом row_info"
          if (!row) {
            return;
          }
          const currentStudents = row.querySelector(".currentnumber");
          const maxStudents = row.querySelector(".maxnumber");
          const recordingBtn = row.querySelector(".btn_recording");

          currentStudents.textContent =
            parseInt(currentStudents.textContent) - 1;
          recordingBtn.style.display = "block";
          canselRecordingBtn.style.display = "none";

          const itemName = row.querySelector("th").textContent;

          // Сохраняем данные в LocalStorage
          localStorage.setItem(itemName, row.innerHTML);
        });
      });
    </script>
  </body>
</html>
